ARG BASE=ubuntu:18.04
FROM ${BASE}

USER root
WORKDIR /root
SHELL [ "/bin/bash", "-c" ]

RUN mkdir -p out/packages

RUN touch out/packages/.gitgnore

RUN apt-get --download-only install -y \
    libopenblas-dev \
    liblapack-dev \
    libatlas-base-dev \
    libboost-all-dev \
    libblas-dev \
    libtiff5-dev \
    libjpeg8-dev \
    libopenjp2-7-dev \
    zlib1g-dev \
    libfreetype6-dev \
    liblcms2-dev \
    libwebp-dev \
    tcl8.6-dev \
    tk8.6-dev \
    python3-tk \
    libharfbuzz-dev \
    libfribidi-dev \
    libxcb1-dev \
    build-essential \
    pkg-config \
    libgtk-3-dev \
    libavcodec-dev \
    libavformat-dev \
    libswscale-dev \
    libv4l-dev \
    libxvidcore-dev \
    libx264-dev \
    libjpeg-dev \
    libpng-dev \
    libtiff-dev \
    gfortran \
    openexr \
    libtbb2 \
    libtbb-dev \
    libdc1394-22-dev \
    adwaita-icon-theme \
    at-spi2-core \
    dconf-gsettings-backend \
    dconf-service \
    fontconfig \
    gdal-data \
    glib-networking \
    glib-networking-common \
    glib-networking-services \
    gsettings-desktop-schemas \
    gtk-update-icon-cache \
    hicolor-icon-theme \
    humanity-icon-theme \
    libaacs0 \
    libaec0 \
    libarmadillo8 \
    libarpack2 \
    libatk-bridge2.0-0 \
    libatk1.0-0 \
    libatk1.0-data \
    libatspi2.0-0 \
    libavahi-client3 \
    libavahi-common-data \
    libavahi-common3 \
    libavcodec57 \
    libavformat57 \
    libavutil55 \
    libbdplus0 \
    libbluray2 \
    libcairo-gobject2 \
    libcairo2 \
    libcharls1 \
    libchromaprint1 \
    libcolord2 \
    libcroco3 \
    libcups2 \
    libdap25 \
    libdapclient6v5 \
    libdatrie1 \
    libdc1394-22 \
    libdconf1 \
    libepoxy0 \
    libepsilon1 \
    libexif12 \
    libfreexl1 \
    libfyba0 \
    libgd3 \
    libgdal20 \
    libgdcm2.8 \
    libgdk-pixbuf2.0-0 \
    libgdk-pixbuf2.0-bin \
    libgdk-pixbuf2.0-common \
    libgeos-3.6.2 \
    libgeos-c1v5 \
    libgeotiff2 \
    libgif7 \
    libgl2ps1.4 \
    libgme0 \
    libgphoto2-6 \
    libgphoto2-l10n \
    libgphoto2-port12 \
    libgsm1 \
    libgtk-3-0 \
    libgtk-3-bin \
    libgtk-3-common \
    libhdf4-0-alt \
    libhdf5-100 \
    libhdf5-openmpi-100 \
    libilmbase12 \
    libjbig0 \
    libjpeg-turbo8 \
    libjpeg8 \
    libjson-c3 \
    libjson-glib-1.0-0 \
    libjson-glib-1.0-common \
    libkmlbase1 \
    libkmldom1 \
    libkmlengine1 \
    liblcms2-2 \
    liblept5 \
    libminizip1 \
    libmp3lame0 \
    libmpg123-0 \
    libmysqlclient20 \
    libnetcdf-c++4 \
    libnetcdf13 \
    libnspr4 \
    libnss3 \
    libodbc1 \
    libogdi3.2 \
    libogg0 \
    libopenexr22 \
    libopenjp2-7 \
    libopenmpt0 \
    libopus0 \
    libpango-1.0-0 \
    libpangocairo-1.0-0 \
    libpangoft2-1.0-0 \
    libpixman-1-0 \
    libpoppler73 \
    libpq5 \
    libproj12 \
    libproxy1v5 \
    libqhull7 \
    libraw1394-11 \
    librest-0.7-0 \
    librsvg2-2 \
    librsvg2-common \
    libshine3 \
    libsnappy1v5 \
    libsocket++1 \
    libsoup-gnome2.4-1 \
    libsoup2.4-1 \
    libsoxr0 \
    libspatialite7 \
    libspeex1 \
    libssh-gcrypt-4 \
    libsuperlu5 \
    libswresample2 \
    libswscale4 \
    libsz2 \
    libtbb2 \
    libtesseract4 \
    libthai-data \
    libthai0 \
    libtheora0 \
    libtiff5 \
    libtwolame0 \
    liburiparser1 \
    libusb-1.0-0 \
    libva-drm2 \
    libva-x11-2 \
    libva2 \
    libvdpau1 \
    libvorbis0a \
    libvorbisenc2 \
    libvorbisfile3 \
    libvpx5 \
    libvtk6.3 \
    libwavpack1 \
    libwayland-client0 \
    libwayland-cursor0 \
    libwayland-egl1 \
    libwebp6 \
    libwebpmux3 \
    libx264-152 \
    libx265-146 \
    libxcb-render0 \
    libxcb-shm0 \
    libxcb-xfixes0 \
    libxcursor1 \
    libxerces-c3.2 \
    libxkbcommon0 \
    libxvidcore4 \
    libzvbi-common \
    libzvbi0 \
    mesa-va-drivers \
    mesa-vdpau-drivers \
    mysql-common \
    odbcinst \
    odbcinst1debian2 \
    poppler-data \
    proj-bin \
    proj-data \
    ubuntu-mono \
    va-driver-all \
    vdpau-driver-all \
    xkb-data

RUN mv /var/cache/apt/archives/*.deb out/packages && \
    ls -l out/packages

COPY clone-packages.sh /usr/local/bin/clone-packages

RUN chmod +x /usr/local/bin/clone-packages

ENTRYPOINT [ "clone-packages" ]
